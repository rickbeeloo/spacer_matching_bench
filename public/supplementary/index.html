<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Uri Neri">
<meta name="author" content="Antonio Pedro Camargo">
<meta name="author" content="Brian Bushnell">
<meta name="author" content="Simon Roux">

<title>Supplementary material for: Tool Choice drastically Impacts CRISPR Spacer-Protospacer Detection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7fd0fe4245b865325b8ce8dccb604d59.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-59d20aacc15edab7c68fcb989406a6ea.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">


<meta name="citation_title" content="Supplementary material for: Tool Choice drastically Impacts CRISPR Spacer-Protospacer Detection">
<meta name="citation_author" content="Uri Neri">
<meta name="citation_author" content="Antonio Pedro Camargo">
<meta name="citation_author" content="Brian Bushnell">
<meta name="citation_author" content="Simon Roux">
<meta name="citation_language" content="en">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Supplementary material for: Tool Choice drastically Impacts CRISPR Spacer-Protospacer Detection</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Uri Neri <a href="mailto:uneri@lbl.gov" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        DOE Joint Genome Institute
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Antonio Pedro Camargo </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        DOE Joint Genome Institute
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Brian Bushnell </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        DOE Joint Genome Institute
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Simon Roux </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        DOE Joint Genome Institute
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="supplementary.pdf"><i class="bi bi-file-pdf"></i>PDF</a></p></div><div class="quarto-title-meta-contents"><p><a href="supplementary.odt"><i class="bi bi-file"></i>OpenOffice</a></p></div><div class="quarto-title-meta-contents"><p><a href="supplementary.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div></div></div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#supplementary-materials" id="toc-supplementary-materials" class="nav-link active" data-scroll-target="#supplementary-materials"><span class="header-section-number">1</span> Supplementary Materials</a>
  <ul class="collapse">
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables"><span class="header-section-number">1.1</span> Tables</a>
  <ul class="collapse">
  <li><a href="#tool-configuration-details" id="toc-tool-configuration-details" class="nav-link" data-scroll-target="#tool-configuration-details"><span class="header-section-number">1.1.1</span> 1. Tool Configuration Details</a></li>
  <li><a href="#recall-values-for-each-tool-at-different-mismatch-thresholds" id="toc-recall-values-for-each-tool-at-different-mismatch-thresholds" class="nav-link" data-scroll-target="#recall-values-for-each-tool-at-different-mismatch-thresholds"><span class="header-section-number">1.1.2</span> 2. Recall values for each tool at different mismatch thresholds</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#figures" id="toc-figures" class="nav-link" data-scroll-target="#figures"><span class="header-section-number">2</span> Figures</a>
  <ul class="collapse">
  <li><a href="#supplementary-figure-1." id="toc-supplementary-figure-1." class="nav-link" data-scroll-target="#supplementary-figure-1."><span class="header-section-number">2.0.1</span> Supplementary figure 1.</a></li>
  <li><a href="#supplementary-figure-2." id="toc-supplementary-figure-2." class="nav-link" data-scroll-target="#supplementary-figure-2."><span class="header-section-number">2.0.2</span> Supplementary figure 2.</a></li>
  <li><a href="#supplementary-figure-3" id="toc-supplementary-figure-3" class="nav-link" data-scroll-target="#supplementary-figure-3"><span class="header-section-number">2.0.3</span> Supplementary figure 3</a></li>
  <li><a href="#supplementary-figure-4." id="toc-supplementary-figure-4." class="nav-link" data-scroll-target="#supplementary-figure-4."><span class="header-section-number">2.0.4</span> Supplementary figure 4.</a></li>
  <li><a href="#supplementary-figure-5." id="toc-supplementary-figure-5." class="nav-link" data-scroll-target="#supplementary-figure-5."><span class="header-section-number">2.0.5</span> Supplementary figure 5.</a></li>
  <li><a href="#supplementary-figure-6." id="toc-supplementary-figure-6." class="nav-link" data-scroll-target="#supplementary-figure-6."><span class="header-section-number">2.0.6</span> Supplementary figure 6.</a></li>
  <li><a href="#supplementary-figure-7." id="toc-supplementary-figure-7." class="nav-link" data-scroll-target="#supplementary-figure-7."><span class="header-section-number">2.0.7</span> Supplementary figure 7.</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="spacer_dbs_timeline-preview.html"><i class="bi bi-journal-code"></i>spacer_dbs_timeline.md</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="supplementary-materials" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Supplementary Materials</h1>
<section id="tables" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="tables"><span class="header-section-number">1.1</span> Tables</h2>
<section id="tool-configuration-details" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="tool-configuration-details"><span class="header-section-number">1.1.1</span> 1. Tool Configuration Details</h3>
<p>For full version and build information see the git repo at <a href="https://code.jgi.doe.gov/spacersdb/spacer_matching_bench">code.jgi.doe.gov/spacersdb/spacer_matching_bench</a></p>
<table class="caption-top table">
<colgroup>
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Tool</th>
<th style="text-align: left;">Version</th>
<th style="text-align: left;">Command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bbmapskimmer</td>
<td style="text-align: left;">39.13</td>
<td style="text-align: left;"><code>bbmapskimmer.sh sam=1.4 maxindel=0 tipsearch=0 midpad=100 in={spacers_file} ref=./{contigs_file} outm={output_dir}/bbmap_skimmer_output.sam t={threads} minid=0.85 path={output_dir}</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">blastn</td>
<td style="text-align: left;">2.16.0+, Dec 14 2024</td>
<td style="text-align: left;"><code>makeblastdb -in {contigs_file} -dbtype nucl -out {output_dir}/contigs_blastdb``blastn -query {spacers_file} -db {output_dir}/contigs_blastdb -max_target_seqs 1000000 -out {output_dir}/blastn_output.tsv -evalue 1e-5 -num_threads {threads} -task blastn-short -outfmt 6 qaccver saccver nident length mismatch qlen gapopen qstart qend sstart send evalue bitscore""</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">bowtie1</td>
<td style="text-align: left;">bowtie-align-s version 1.3.1</td>
<td style="text-align: left;"><code>bowtie-build --threads {threads} {contigs_file} {results_dir}/simulated_data/bt1_contigs_index``bowtie --threads {threads} -f --all -v 3 -x {results_dir}/simulated_data/bt1_contigs_index {spacers_file} -S {output_dir}/bowtie1_output.sam</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">bowtie2</td>
<td style="text-align: left;">bowtie2-align-s 2.5.4</td>
<td style="text-align: left;"><code>bowtie2-build --large-index --threads {threads} {contigs_file} {results_dir}/simulated_data/contigs_bt2indx``bowtie2 --all --xeq --very-sensitive -x {results_dir}/simulated_data/contigs_bt2indx -f {spacers_file} -S {output_dir}/bowtie2_output.sam --threads {threads}</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">hisat2</td>
<td style="text-align: left;">hisat2-align-s 2.2.1</td>
<td style="text-align: left;"><code>hisat2-build -p {threads} {contigs_file} {output_dir}/hisat2_idx``hisat2 -a --no-spliced-alignment --no-unal --no-softclip --secondary -p {threads} -x {output_dir}/hisat2_idx -f {spacers_file} -S {output_dir}/hisat2_output.sam</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">lexicmap</td>
<td style="text-align: left;">v0.5.0 (06741c8)</td>
<td style="text-align: left;"><code>mkdir -p {output_dir}/tmp_lexicmap_contigs {output_dir}/tmp_lexicmap_spacers``cp {contigs_file} {output_dir}/tmp_lexicmap_contigs/simulated_contigs.fa``cp {spacers_file} {output_dir}/tmp_lexicmap_spacers/simulated_spacers.fa``lexicmap index -k 15 -m 40000 --seed-max-desert 200 --seed-in-desert-dist 50 -I {output_dir}/tmp_lexicmap_contigs -O {output_dir}/tmp_lexicmap.lmi``lexicmap search -d {output_dir}/tmp_lexicmap.lmi {output_dir}/tmp_lexicmap_spacers/simulated_spacers.fa -o {output_dir}/lexicmap_output.tsv --threads {threads} --align-min-match-len 17 --align-min-match-pident 85 --seed-min-prefix 15 --seed-min-single-prefix 15 --seed-max-dist 100 --seed-max-gap 100 --align-max-gap 20 --align-band 100 --top-n-genomes 0 -a</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">minimap2</td>
<td style="text-align: left;">2.28-r1209</td>
<td style="text-align: left;"><code>minimap2 -N 100 --eqx -t {threads} -a {contigs_file} {spacers_file} -o {output_dir}/minimap2_output.sam</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">mmseqs2</td>
<td style="text-align: left;">db8ad2d14d0a285ce0ad62bbefd0dce927663315</td>
<td style="text-align: left;"><code>mkdir -p {output_dir}/tmp_spacers {output_dir}/tmp_contigs {output_dir}/tmp_mmseqs {output_dir}/tmp_mmseqs_outputs``mmseqs createdb {spacers_file} {output_dir}/tmp_spacers/mmdb``mmseqs createdb {contigs_file} {output_dir}/tmp_contigs/mmdb``mmseqs search {output_dir}/tmp_spacers/mmdb {output_dir}/tmp_contigs/mmdb {output_dir}/tmp_mmseqs_outputs/mmseqs_output {output_dir}/tmp_mmseqs --min-seq-id 0.85 --min-aln-len 17 --threads {threads} -a --search-type 3 -v 1``mmseqs convertalis {output_dir}/tmp_spacers/mmdb {output_dir}/tmp_contigs/mmdb {output_dir}/tmp_mmseqs_outputs/mmseqs_output {output_dir}/mmseqs_output.tsv --format-mode 0 --search-type 4 --format-output query,target,nident,alnlen,mismatch,qlen,gapopen,qstart,qend,tstart,tend,evalue,bits</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mummer4</td>
<td style="text-align: left;">4.1.0-r1304 // 4.1</td>
<td style="text-align: left;"><code>nucmer --maxmatch --nosimplify --batch=10000000 --threads {threads} --sam-long={output_dir}/mummer4_output.sam -c 1 {contigs_file} {spacers_file}</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">spacer_containment</td>
<td style="text-align: left;">0.1.0</td>
<td style="text-align: left;"><code>spacer-containment --n-threads {threads} {contigs_file} {spacers_file} &gt; {output_dir}/spacer_containment_output.tsv</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">strobealign</td>
<td style="text-align: left;">0.15.0</td>
<td style="text-align: left;"><code>strobealign --eqx -k 15 -N 1000 -t {threads} {contigs_file} {spacers_file} -o {output_dir}/strobealign_output.sam</code></td>
</tr>
</tbody>
</table>
</section>
<section id="recall-values-for-each-tool-at-different-mismatch-thresholds" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="recall-values-for-each-tool-at-different-mismatch-thresholds"><span class="header-section-number">1.1.2</span> 2. Recall values for each tool at different mismatch thresholds</h3>
<section id="a.-imgvr4-dataset" class="level4" data-number="1.1.2.1">
<h4 data-number="1.1.2.1" class="anchored" data-anchor-id="a.-imgvr4-dataset"><span class="header-section-number">1.1.2.1</span> A. IMG/VR4 dataset</h4>
<p>Every row lists the results for a specific mismatch threshold and tool.<br>
The values are for exact mismatches (not max), and represent the total number of unique spacer-contig pairs (aligning at that mismatch threshold).<br>
The fraction is tool_matches divided by total_possible.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 19%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>mismatches</th>
<th>tool</th>
<th>total_possible</th>
<th>tool_matches</th>
<th>fraction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>mummer4</td>
<td>16866829</td>
<td>16866546</td>
<td>0.9999832</td>
</tr>
<tr class="even">
<td>0</td>
<td>mmseqs2</td>
<td>16866829</td>
<td>15803286</td>
<td>0.9369447</td>
</tr>
<tr class="odd">
<td>0</td>
<td>bowtie1</td>
<td>16866829</td>
<td>16866784</td>
<td>0.9999973</td>
</tr>
<tr class="even">
<td>0</td>
<td>lexicmap</td>
<td>16866829</td>
<td>6033115</td>
<td>0.3576911</td>
</tr>
<tr class="odd">
<td>0</td>
<td>minimap2</td>
<td>16866829</td>
<td>5110</td>
<td>0.000303</td>
</tr>
<tr class="even">
<td>0</td>
<td>strobealign</td>
<td>16866829</td>
<td>4233236</td>
<td>0.25098</td>
</tr>
<tr class="odd">
<td>0</td>
<td>blastn</td>
<td>16866829</td>
<td>16850968</td>
<td>0.9990596</td>
</tr>
<tr class="even">
<td>0</td>
<td>bbmap_skimmer</td>
<td>16866829</td>
<td>14978104</td>
<td>0.8880213</td>
</tr>
<tr class="odd">
<td>0</td>
<td>bowtie2</td>
<td>16866829</td>
<td>16866667</td>
<td>0.9999904</td>
</tr>
<tr class="even">
<td>1</td>
<td>mummer4</td>
<td>12197007</td>
<td>8032640</td>
<td>0.6585747</td>
</tr>
<tr class="odd">
<td>1</td>
<td>mmseqs2</td>
<td>12197007</td>
<td>9805301</td>
<td>0.8039104</td>
</tr>
<tr class="even">
<td>1</td>
<td>bowtie1</td>
<td>12197007</td>
<td>11992384</td>
<td>0.9832235</td>
</tr>
<tr class="odd">
<td>1</td>
<td>lexicmap</td>
<td>12197007</td>
<td>835330</td>
<td>0.0684865</td>
</tr>
<tr class="even">
<td>1</td>
<td>minimap2</td>
<td>12197007</td>
<td>1086</td>
<td>0.000089038237</td>
</tr>
<tr class="odd">
<td>1</td>
<td>strobealign</td>
<td>12197007</td>
<td>1311189</td>
<td>0.1075009</td>
</tr>
<tr class="even">
<td>1</td>
<td>blastn</td>
<td>12197007</td>
<td>7318398</td>
<td>0.6000159</td>
</tr>
<tr class="odd">
<td>1</td>
<td>bbmap_skimmer</td>
<td>12197007</td>
<td>2413864</td>
<td>0.1979063</td>
</tr>
<tr class="even">
<td>1</td>
<td>bowtie2</td>
<td>12197007</td>
<td>12112313</td>
<td>0.9930562</td>
</tr>
<tr class="odd">
<td>2</td>
<td>mummer4</td>
<td>12359867</td>
<td>3129926</td>
<td>0.253233</td>
</tr>
<tr class="even">
<td>2</td>
<td>mmseqs2</td>
<td>12359867</td>
<td>6756086</td>
<td>0.5466148</td>
</tr>
<tr class="odd">
<td>2</td>
<td>bowtie1</td>
<td>12359867</td>
<td>11173197</td>
<td>0.9039901</td>
</tr>
<tr class="even">
<td>2</td>
<td>lexicmap</td>
<td>12359867</td>
<td>426554</td>
<td>0.0345112</td>
</tr>
<tr class="odd">
<td>2</td>
<td>minimap2</td>
<td>12359867</td>
<td>667</td>
<td>0.000053964982</td>
</tr>
<tr class="even">
<td>2</td>
<td>strobealign</td>
<td>12359867</td>
<td>375251</td>
<td>0.0303604</td>
</tr>
<tr class="odd">
<td>2</td>
<td>blastn</td>
<td>12359867</td>
<td>3217012</td>
<td>0.2602789</td>
</tr>
<tr class="even">
<td>2</td>
<td>bbmap_skimmer</td>
<td>12359867</td>
<td>1047205</td>
<td>0.0847262</td>
</tr>
<tr class="odd">
<td>2</td>
<td>bowtie2</td>
<td>12359867</td>
<td>5243454</td>
<td>0.4242322</td>
</tr>
<tr class="even">
<td>3</td>
<td>mummer4</td>
<td>16472212</td>
<td>673444</td>
<td>0.0408836</td>
</tr>
<tr class="odd">
<td>3</td>
<td>mmseqs2</td>
<td>16472212</td>
<td>3560155</td>
<td>0.216131</td>
</tr>
<tr class="even">
<td>3</td>
<td>bowtie1</td>
<td>16472212</td>
<td>14523177</td>
<td>0.8816774</td>
</tr>
<tr class="odd">
<td>3</td>
<td>lexicmap</td>
<td>16472212</td>
<td>430208</td>
<td>0.0261172</td>
</tr>
<tr class="even">
<td>3</td>
<td>minimap2</td>
<td>16472212</td>
<td>392</td>
<td>0.000023797654</td>
</tr>
<tr class="odd">
<td>3</td>
<td>strobealign</td>
<td>16472212</td>
<td>88246</td>
<td>0.0053573</td>
</tr>
<tr class="even">
<td>3</td>
<td>blastn</td>
<td>16472212</td>
<td>1972148</td>
<td>0.1197258</td>
</tr>
<tr class="odd">
<td>3</td>
<td>bbmap_skimmer</td>
<td>16472212</td>
<td>630914</td>
<td>0.0383017</td>
</tr>
<tr class="even">
<td>3</td>
<td>bowtie2</td>
<td>16472212</td>
<td>2998722</td>
<td>0.1820473</td>
</tr>
</tbody>
</table>
</section>
<section id="b.-synthetic-dataset" class="level4" data-number="1.1.2.2">
<h4 data-number="1.1.2.2" class="anchored" data-anchor-id="b.-synthetic-dataset"><span class="header-section-number">1.1.2.2</span> B. Synthetic dataset</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>mismatches</th>
<th>tool</th>
<th>total_possible</th>
<th>tool_matches</th>
<th>recall</th>
<th>false_positives</th>
<th>false_negatives</th>
<th>precision</th>
<th>f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>minimap2</td>
<td>1899024</td>
<td>176</td>
<td>0.00009267918678</td>
<td>49</td>
<td>1898848</td>
<td>0.7822222222</td>
<td>0.0001853364146</td>
</tr>
<tr class="even">
<td>0</td>
<td>bbmapskimmer</td>
<td>1899024</td>
<td>377426</td>
<td>0.1987473565</td>
<td>1010</td>
<td>1521598</td>
<td>0.9973311207</td>
<td>0.3314446796</td>
</tr>
<tr class="odd">
<td>0</td>
<td>mmseqs2map</td>
<td>1899024</td>
<td>1021533</td>
<td>0.5379252711</td>
<td>57809</td>
<td>877491</td>
<td>0.9464405165</td>
<td>0.6859687493</td>
</tr>
<tr class="even">
<td>0</td>
<td>mmseqs2</td>
<td>1899024</td>
<td>1021533</td>
<td>0.5379252711</td>
<td>134608</td>
<td>877491</td>
<td>0.8835712945</td>
<td>0.6687252571</td>
</tr>
<tr class="odd">
<td>0</td>
<td>minimap2_mod</td>
<td>1899024</td>
<td>176</td>
<td>0.00009267918678</td>
<td>49</td>
<td>1898848</td>
<td>0.7822222222</td>
<td>0.0001853364146</td>
</tr>
<tr class="even">
<td>0</td>
<td>bowtie1</td>
<td>1899024</td>
<td>1899024</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>0</td>
<td>bbmapskimmermod</td>
<td>1899024</td>
<td>1899024</td>
<td>1</td>
<td>1130</td>
<td>0</td>
<td>0.9994053114</td>
<td>0.9997025672</td>
</tr>
<tr class="even">
<td>0</td>
<td>bwa_mem</td>
<td>1899024</td>
<td>683227</td>
<td>0.3597779702</td>
<td>15626</td>
<td>1215797</td>
<td>0.9776405052</td>
<td>0.5259887208</td>
</tr>
<tr class="odd">
<td>0</td>
<td>lexicmap</td>
<td>1899024</td>
<td>1427612</td>
<td>0.7517609045</td>
<td>469844</td>
<td>471412</td>
<td>0.7523821369</td>
<td>0.7520713924</td>
</tr>
<tr class="even">
<td>0</td>
<td>hisat2</td>
<td>1899024</td>
<td>1875654</td>
<td>0.9876936784</td>
<td>3</td>
<td>23370</td>
<td>0.9999984006</td>
<td>0.9938079536</td>
</tr>
<tr class="odd">
<td>0</td>
<td>minimap2_og</td>
<td>1899024</td>
<td>48</td>
<td>0.00002527614185</td>
<td>6</td>
<td>1898976</td>
<td>0.8888888889</td>
<td>0.00005055084625</td>
</tr>
<tr class="even">
<td>0</td>
<td>spacer_containment</td>
<td>1899024</td>
<td>1899024</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>0</td>
<td>bowtie2</td>
<td>1899024</td>
<td>1899024</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0.9999984202</td>
<td>0.9999992101</td>
</tr>
<tr class="even">
<td>0</td>
<td>blastn</td>
<td>1899024</td>
<td>1745238</td>
<td>0.919018401</td>
<td>596453</td>
<td>153786</td>
<td>0.7452896219</td>
<td>0.8230866729</td>
</tr>
<tr class="odd">
<td>0</td>
<td>mummer4</td>
<td>1899024</td>
<td>1860393</td>
<td>0.9796574451</td>
<td>250245</td>
<td>38631</td>
<td>0.881436324</td>
<td>0.9279550246</td>
</tr>
<tr class="even">
<td>0</td>
<td>strobealign</td>
<td>1899024</td>
<td>42016</td>
<td>0.0221250495</td>
<td>193</td>
<td>1857008</td>
<td>0.9954275155</td>
<td>0.04328795152</td>
</tr>
<tr class="odd">
<td>1</td>
<td>minimap2</td>
<td>1992339</td>
<td>86</td>
<td>0.00004316534485</td>
<td>49</td>
<td>1992253</td>
<td>0.637037037</td>
<td>0.00008632484037</td>
</tr>
<tr class="even">
<td>1</td>
<td>bbmapskimmer</td>
<td>1992339</td>
<td>814246</td>
<td>0.4086884812</td>
<td>1010</td>
<td>1178093</td>
<td>0.9987611253</td>
<td>0.5800309518</td>
</tr>
<tr class="odd">
<td>1</td>
<td>mmseqs2map</td>
<td>1992339</td>
<td>982267</td>
<td>0.4930220209</td>
<td>57809</td>
<td>1010072</td>
<td>0.9444184848</td>
<td>0.6478447046</td>
</tr>
<tr class="even">
<td>1</td>
<td>mmseqs2</td>
<td>1992339</td>
<td>971696</td>
<td>0.4877161969</td>
<td>134608</td>
<td>1020643</td>
<td>0.8783263913</td>
<td>0.627175186</td>
</tr>
<tr class="odd">
<td>1</td>
<td>minimap2_mod</td>
<td>1992339</td>
<td>86</td>
<td>0.00004316534485</td>
<td>49</td>
<td>1992253</td>
<td>0.637037037</td>
<td>0.00008632484037</td>
</tr>
<tr class="even">
<td>1</td>
<td>bowtie1</td>
<td>1992339</td>
<td>1924529</td>
<td>0.9659646275</td>
<td>0</td>
<td>67810</td>
<td>1</td>
<td>0.9826876984</td>
</tr>
<tr class="odd">
<td>1</td>
<td>bbmapskimmermod</td>
<td>1992339</td>
<td>1903036</td>
<td>0.9551768048</td>
<td>1130</td>
<td>89303</td>
<td>0.9994065643</td>
<td>0.9767912527</td>
</tr>
<tr class="even">
<td>1</td>
<td>bwa_mem</td>
<td>1992339</td>
<td>569097</td>
<td>0.2856426542</td>
<td>15626</td>
<td>1423242</td>
<td>0.9732762351</td>
<td>0.4416634136</td>
</tr>
<tr class="odd">
<td>1</td>
<td>lexicmap</td>
<td>1992339</td>
<td>848885</td>
<td>0.4260745787</td>
<td>469844</td>
<td>1143454</td>
<td>0.643714516</td>
<td>0.512756005</td>
</tr>
<tr class="even">
<td>1</td>
<td>hisat2</td>
<td>1992339</td>
<td>1638156</td>
<td>0.8222275426</td>
<td>3</td>
<td>354183</td>
<td>0.9999981687</td>
<td>0.9024414832</td>
</tr>
<tr class="odd">
<td>1</td>
<td>minimap2_og</td>
<td>1992339</td>
<td>12</td>
<td>0.00000602</td>
<td>6</td>
<td>1992327</td>
<td>0.6666666667</td>
<td>0.00001204603392</td>
</tr>
<tr class="even">
<td>1</td>
<td>spacer_containment</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>1</td>
<td>bowtie2</td>
<td>1992339</td>
<td>1924529</td>
<td>0.9659646275</td>
<td>3</td>
<td>67810</td>
<td>0.9999984412</td>
<td>0.9826869458</td>
</tr>
<tr class="even">
<td>1</td>
<td>blastn</td>
<td>1992339</td>
<td>1534121</td>
<td>0.7700100234</td>
<td>596453</td>
<td>458218</td>
<td>0.7200505591</td>
<td>0.7441927589</td>
</tr>
<tr class="odd">
<td>1</td>
<td>mummer4</td>
<td>1992339</td>
<td>1605268</td>
<td>0.8057203117</td>
<td>250245</td>
<td>387071</td>
<td>0.8651343321</td>
<td>0.8343709685</td>
</tr>
<tr class="even">
<td>1</td>
<td>strobealign</td>
<td>1992339</td>
<td>39698</td>
<td>0.01992532395</td>
<td>193</td>
<td>1952641</td>
<td>0.9951618159</td>
<td>0.03906841253</td>
</tr>
<tr class="odd">
<td>2</td>
<td>minimap2</td>
<td>2137067</td>
<td>91</td>
<td>0.00004258172533</td>
<td>49</td>
<td>2136976</td>
<td>0.65</td>
<td>0.00008515787193</td>
</tr>
<tr class="even">
<td>2</td>
<td>bbmapskimmer</td>
<td>2137067</td>
<td>804812</td>
<td>0.3765965222</td>
<td>1010</td>
<td>1332255</td>
<td>0.9987466215</td>
<td>0.5469536907</td>
</tr>
<tr class="odd">
<td>2</td>
<td>mmseqs2map</td>
<td>2137067</td>
<td>912682</td>
<td>0.4270722443</td>
<td>57809</td>
<td>1224385</td>
<td>0.9404332446</td>
<td>0.5873949899</td>
</tr>
<tr class="even">
<td>2</td>
<td>mmseqs2</td>
<td>2137067</td>
<td>901193</td>
<td>0.4216961845</td>
<td>134608</td>
<td>1235874</td>
<td>0.8700445356</td>
<td>0.5680620814</td>
</tr>
<tr class="odd">
<td>2</td>
<td>minimap2_mod</td>
<td>2137067</td>
<td>91</td>
<td>0.00004258172533</td>
<td>49</td>
<td>2136976</td>
<td>0.65</td>
<td>0.00008515787193</td>
</tr>
<tr class="even">
<td>2</td>
<td>bowtie1</td>
<td>2137067</td>
<td>1934586</td>
<td>0.9052528536</td>
<td>0</td>
<td>202481</td>
<td>1</td>
<td>0.9502705658</td>
</tr>
<tr class="odd">
<td>2</td>
<td>bbmapskimmermod</td>
<td>2137067</td>
<td>1734297</td>
<td>0.811531412</td>
<td>1130</td>
<td>402770</td>
<td>0.9993488634</td>
<td>0.8957002903</td>
</tr>
<tr class="even">
<td>2</td>
<td>bwa_mem</td>
<td>2137067</td>
<td>515856</td>
<td>0.2413850385</td>
<td>15626</td>
<td>1621211</td>
<td>0.9705991924</td>
<td>0.3866190952</td>
</tr>
<tr class="odd">
<td>2</td>
<td>lexicmap</td>
<td>2137067</td>
<td>562385</td>
<td>0.2631574022</td>
<td>469844</td>
<td>1574682</td>
<td>0.544825809</td>
<td>0.3548958507</td>
</tr>
<tr class="even">
<td>2</td>
<td>hisat2</td>
<td>2137067</td>
<td>1115625</td>
<td>0.5220355749</td>
<td>3</td>
<td>1021442</td>
<td>0.9999973109</td>
<td>0.6859696344</td>
</tr>
<tr class="odd">
<td>2</td>
<td>minimap2_og</td>
<td>2137067</td>
<td>26</td>
<td>0.00001216620724</td>
<td>6</td>
<td>2137041</td>
<td>0.8125</td>
<td>0.00002433205013</td>
</tr>
<tr class="even">
<td>2</td>
<td>spacer_containment</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2</td>
<td>bowtie2</td>
<td>2137067</td>
<td>1573821</td>
<td>0.7364397092</td>
<td>3</td>
<td>563246</td>
<td>0.9999980938</td>
<td>0.8482173149</td>
</tr>
<tr class="even">
<td>2</td>
<td>blastn</td>
<td>2137067</td>
<td>1355458</td>
<td>0.6342608819</td>
<td>596453</td>
<td>781609</td>
<td>0.6944261291</td>
<td>0.6629813122</td>
</tr>
<tr class="odd">
<td>2</td>
<td>mummer4</td>
<td>2137067</td>
<td>1432751</td>
<td>0.6704286763</td>
<td>250245</td>
<td>704316</td>
<td>0.851309807</td>
<td>0.7501190425</td>
</tr>
<tr class="even">
<td>2</td>
<td>strobealign</td>
<td>2137067</td>
<td>34729</td>
<td>0.01625077735</td>
<td>193</td>
<td>2102338</td>
<td>0.9944733979</td>
<td>0.03197898332</td>
</tr>
<tr class="odd">
<td>3</td>
<td>minimap2</td>
<td>2609997</td>
<td>220</td>
<td>0.00008429128463</td>
<td>49</td>
<td>2609777</td>
<td>0.8178438662</td>
<td>0.000168565196</td>
</tr>
<tr class="even">
<td>3</td>
<td>bbmapskimmer</td>
<td>2609997</td>
<td>760618</td>
<td>0.291424856</td>
<td>1010</td>
<td>1849379</td>
<td>0.9986738933</td>
<td>0.4511877804</td>
</tr>
<tr class="odd">
<td>3</td>
<td>mmseqs2map</td>
<td>2609997</td>
<td>860977</td>
<td>0.3298766244</td>
<td>57809</td>
<td>1749020</td>
<td>0.9370811048</td>
<td>0.4879738992</td>
</tr>
<tr class="even">
<td>3</td>
<td>mmseqs2</td>
<td>2609997</td>
<td>862278</td>
<td>0.3303750924</td>
<td>134608</td>
<td>1747719</td>
<td>0.8649715213</td>
<td>0.4781291769</td>
</tr>
<tr class="odd">
<td>3</td>
<td>minimap2_mod</td>
<td>2609997</td>
<td>228</td>
<td>0.00008735642225</td>
<td>49</td>
<td>2609769</td>
<td>0.8231046931</td>
<td>0.0001746943041</td>
</tr>
<tr class="even">
<td>3</td>
<td>bowtie1</td>
<td>2609997</td>
<td>2238309</td>
<td>0.8575906409</td>
<td>0</td>
<td>371688</td>
<td>1</td>
<td>0.9233365221</td>
</tr>
<tr class="odd">
<td>3</td>
<td>bbmapskimmermod</td>
<td>2609997</td>
<td>1534102</td>
<td>0.5877792197</td>
<td>1130</td>
<td>1075895</td>
<td>0.9992639549</td>
<td>0.7401772013</td>
</tr>
<tr class="even">
<td>3</td>
<td>bwa_mem</td>
<td>2609997</td>
<td>497712</td>
<td>0.1906944721</td>
<td>15626</td>
<td>2112285</td>
<td>0.969560017</td>
<td>0.3187054863</td>
</tr>
<tr class="odd">
<td>3</td>
<td>lexicmap</td>
<td>2609997</td>
<td>443019</td>
<td>0.1697392756</td>
<td>469844</td>
<td>2166978</td>
<td>0.4853072148</td>
<td>0.2515109882</td>
</tr>
<tr class="even">
<td>3</td>
<td>hisat2</td>
<td>2609997</td>
<td>564049</td>
<td>0.2161109764</td>
<td>3</td>
<td>2045948</td>
<td>0.9999946813</td>
<td>0.3554129127</td>
</tr>
<tr class="odd">
<td>3</td>
<td>minimap2_og</td>
<td>2609997</td>
<td>35</td>
<td>0.0000134099771</td>
<td>6</td>
<td>2609962</td>
<td>0.8536585366</td>
<td>0.0000268195329</td>
</tr>
<tr class="even">
<td>3</td>
<td>spacer_containment</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>bowtie2</td>
<td>2609997</td>
<td>1415300</td>
<td>0.5422611597</td>
<td>3</td>
<td>1194697</td>
<td>0.9999978803</td>
<td>0.7032022458</td>
</tr>
<tr class="even">
<td>3</td>
<td>blastn</td>
<td>2609997</td>
<td>1270806</td>
<td>0.4868994102</td>
<td>596453</td>
<td>1339191</td>
<td>0.6805729682</td>
<td>0.5676718061</td>
</tr>
<tr class="odd">
<td>3</td>
<td>mummer4</td>
<td>2609997</td>
<td>1338301</td>
<td>0.5127595932</td>
<td>250245</td>
<td>1271696</td>
<td>0.842469151</td>
<td>0.6375073448</td>
</tr>
<tr class="even">
<td>3</td>
<td>strobealign</td>
<td>2609997</td>
<td>30913</td>
<td>0.01184407492</td>
<td>193</td>
<td>2579084</td>
<td>0.9937954092</td>
<td>0.02340915898</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>
<section id="figures" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Figures</h1>
<section id="supplementary-figure-1." class="level3" data-number="2.0.1">
<h3 data-number="2.0.1" class="anchored" data-anchor-id="supplementary-figure-1."><span class="header-section-number">2.0.1</span> Supplementary figure 1.</h3>
<p>Benchmarking framework pipeline overview.</p>
<p><a href="figures/supp/workflow.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="figures/supp/workflow.svg" class="img-fluid"></a></p>
</section>
<section id="supplementary-figure-2." class="level3" data-number="2.0.2">
<h3 data-number="2.0.2" class="anchored" data-anchor-id="supplementary-figure-2."><span class="header-section-number">2.0.2</span> Supplementary figure 2.</h3>
<p>IMG/VR v4 based results in a tool vs tool comparison. Unlike the similar matrix in the main text(figure 1) which showcases the values for up to 1 and 3 mismatches, here the matrixes are separated for each mismatch threshold at an <strong>exact</strong> mismatch value. From top left to bottom right, the mismatch threshold is 0, 1, 2, 3. Like the main text figure, the value of a cell(i,j) is the fraction of spacer-contig pairs identified by the tool listed in row i, which were not identified by the tool listed in the j column.</p>
<p><a href="figures/supp/real_data_matrix_combined.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="figures/supp/real_data_matrix_combined.svg" class="img-fluid"></a></p>
</section>
<section id="supplementary-figure-3" class="level3" data-number="2.0.3">
<h3 data-number="2.0.3" class="anchored" data-anchor-id="supplementary-figure-3"><span class="header-section-number">2.0.3</span> Supplementary figure 3</h3>
<p>Simulated dataset performance metrics.<br>
Precision = True Positives / (True Positives + False Positives)<br>
Recall = True Positives / (True Positives + False Negatives)<br>
F1 = 2 * (Precision * Recall) / (Precision + Recall)<br>
Note: Because of the various prefiltering steps, the number of False Negatives and False Positives may not be indicative of the actual raw tool-reported results. As such, we recommend focusing on the recall rate between tools, which is equivalent to the fraction of detected spacer-protospacer pairs out of all the spacer-protospacer pairs in the reference file.</p>
<p><a href="figures/supp/simulated_tool_performance_by_mismatches.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="figures/supp/simulated_tool_performance_by_mismatches.svg" class="img-fluid"></a></p>
</section>
<section id="supplementary-figure-4." class="level3" data-number="2.0.4">
<h3 data-number="2.0.4" class="anchored" data-anchor-id="supplementary-figure-4."><span class="header-section-number">2.0.4</span> Supplementary figure 4.</h3>
<p><strong>Simulated dataset</strong> recall (detection fraction) for different values of spacer occurrences.</p>
<section id="a.-for-exact-mismatches-in-a-contig-dependent-manner" class="level4" data-number="2.0.4.1">
<h4 data-number="2.0.4.1" class="anchored" data-anchor-id="a.-for-exact-mismatches-in-a-contig-dependent-manner"><span class="header-section-number">2.0.4.1</span> A. for exact mismatches, in a contig dependent manner</h4>
<p>Per contigs manner means the that the recall measure is the fraction of occurences each tool identified out of the total number of spacer-contig pairs, identified by all tools.<br>
1. 0 mismatches</p>
<p><a href="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_0.svg" class="img-fluid"></a></p>
<ol start="2" type="1">
<li>exactly 1 mismatch</li>
</ol>
<p><a href="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_1.svg" class="img-fluid"></a></p>
<ol start="3" type="1">
<li>exactly 2 mismatches</li>
</ol>
<p><a href="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_2.svg" class="img-fluid"></a></p>
<ol start="4" type="1">
<li>exactly 3 mismatches</li>
</ol>
<p><a href="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_3.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="figures/supp/simulated_recall_vs_occurrences_with_contig_id_exact_nm_3.svg" class="img-fluid"></a></p>
</section>
<section id="b.-up-to-1-and-3-mismatches-in-a-contig-independent-manner" class="level4" data-number="2.0.4.2">
<h4 data-number="2.0.4.2" class="anchored" data-anchor-id="b.-up-to-1-and-3-mismatches-in-a-contig-independent-manner"><span class="header-section-number">2.0.4.2</span> B. up to 1 and 3 mismatches, in a contig independent manner</h4>
<p>Per contig independent manner means that the recall measure is the fraction of occurences each tool identified out of the total number of times the spacer occurs in the reference file (regardless of in which contig).<br>
1. up to 1 mismatches</p>
<p><a href="figures/supp/simulated_recall_vs_occurrences_max_nm_1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="figures/supp/simulated_recall_vs_occurrences_max_nm_1.svg" class="img-fluid"></a></p>
<ol start="2" type="1">
<li>up to 3 mismatches</li>
</ol>
<p><a href="figures/supp/simulated_recall_vs_occurrences_max_nm_3.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="figures/supp/simulated_recall_vs_occurrences_max_nm_3.svg" class="img-fluid"></a></p>
</section>
</section>
<section id="supplementary-figure-5." class="level3" data-number="2.0.5">
<h3 data-number="2.0.5" class="anchored" data-anchor-id="supplementary-figure-5."><span class="header-section-number">2.0.5</span> Supplementary figure 5.</h3>
<p>Tool recall versus occurrence frequency for <strong>IMG/VR4 dataset</strong>.<br>
Similar to main text figure, except for exact values for different mismatch thresholds (0-3).</p>
<section id="a.-0-mismatches" class="level4" data-number="2.0.5.1">
<h4 data-number="2.0.5.1" class="anchored" data-anchor-id="a.-0-mismatches"><span class="header-section-number">2.0.5.1</span> A. 0 mismatches</h4>
<p><a href="figures/supp/real_data_recall_vs_occurrences_exact_nm_0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="figures/supp/real_data_recall_vs_occurrences_exact_nm_0.svg" class="img-fluid"></a></p>
</section>
<section id="b.-1-mismatch" class="level4" data-number="2.0.5.2">
<h4 data-number="2.0.5.2" class="anchored" data-anchor-id="b.-1-mismatch"><span class="header-section-number">2.0.5.2</span> B. 1 mismatch</h4>
<p><a href="figures/supp/real_data_recall_vs_occurrences_exact_nm_1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="figures/supp/real_data_recall_vs_occurrences_exact_nm_1.svg" class="img-fluid"></a></p>
</section>
<section id="c.-2-mismatches" class="level4" data-number="2.0.5.3">
<h4 data-number="2.0.5.3" class="anchored" data-anchor-id="c.-2-mismatches"><span class="header-section-number">2.0.5.3</span> C. 2 mismatches</h4>
<p><a href="figures/supp/real_data_recall_vs_occurrences_exact_nm_2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="figures/supp/real_data_recall_vs_occurrences_exact_nm_2.svg" class="img-fluid"></a></p>
</section>
<section id="d.-3-mismatches" class="level4" data-number="2.0.5.4">
<h4 data-number="2.0.5.4" class="anchored" data-anchor-id="d.-3-mismatches"><span class="header-section-number">2.0.5.4</span> D. 3 mismatches</h4>
<p><a href="figures/supp/real_data_recall_vs_occurrences_exact_nm_3.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="figures/supp/real_data_recall_vs_occurrences_exact_nm_3.svg" class="img-fluid"></a></p>
</section>
</section>
<section id="supplementary-figure-6." class="level3" data-number="2.0.6">
<h3 data-number="2.0.6" class="anchored" data-anchor-id="supplementary-figure-6."><span class="header-section-number">2.0.6</span> Supplementary figure 6.</h3>
<p>Distributions of spacers characteristics.<br>
(A) Spacer size (length in bp)<br>
(B) Mismatches observed in spacer alignments<br>
(C) Spacer occurrence rate.</p>
<section id="imgvr4-dataset" class="level4" data-number="2.0.6.1">
<h4 data-number="2.0.6.1" class="anchored" data-anchor-id="imgvr4-dataset"><span class="header-section-number">2.0.6.1</span> 1. IMG/VR4 dataset</h4>
<p><strong>Note:</strong> the horizontal axis is logarithmic.</p>
<p><a href="figures/supp/real_data_spacer_distributions.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="figures/supp/real_data_spacer_distributions.svg" class="img-fluid"></a></p>
</section>
<section id="synthetic-dataset" class="level4" data-number="2.0.6.2">
<h4 data-number="2.0.6.2" class="anchored" data-anchor-id="synthetic-dataset"><span class="header-section-number">2.0.6.2</span> 2. Synthetic dataset</h4>
<p><a href="figures/supp/simulated_spacer_distributions.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="figures/supp/simulated_spacer_distributions.svg" class="img-fluid"></a></p>
</section>
</section>
<section id="supplementary-figure-7." class="level3" data-number="2.0.7">
<h3 data-number="2.0.7" class="anchored" data-anchor-id="supplementary-figure-7."><span class="header-section-number">2.0.7</span> Supplementary figure 7.</h3>
<p>Upset plot of tool performance for IMG/VR4 dataset. The panels (from top to bottom) are sorted by number of mismatches. The sets in each panel are sorted from left to right by the set size. Each row in each panel represents a tool, and the vertical lines connecting the dots indicate the intersection of the connected tool results’.</p>
<section id="a.-0-mismatches-1" class="level4" data-number="2.0.7.1">
<h4 data-number="2.0.7.1" class="anchored" data-anchor-id="a.-0-mismatches-1"><span class="header-section-number">2.0.7.1</span> A. 0 mismatches</h4>
<p><a href="figures/supp/upset_0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="figures/supp/upset_0.svg" class="img-fluid"></a></p>
</section>
<section id="b.-1-mismatch-1" class="level4" data-number="2.0.7.2">
<h4 data-number="2.0.7.2" class="anchored" data-anchor-id="b.-1-mismatch-1"><span class="header-section-number">2.0.7.2</span> B. 1 mismatch</h4>
<p><a href="figures/supp/upset_1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="figures/supp/upset_1.svg" class="img-fluid"></a></p>
</section>
<section id="c.-2-mismatches-1" class="level4" data-number="2.0.7.3">
<h4 data-number="2.0.7.3" class="anchored" data-anchor-id="c.-2-mismatches-1"><span class="header-section-number">2.0.7.3</span> C. 2 mismatches</h4>
<p><a href="figures/supp/upset_2.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="figures/supp/upset_2.svg" class="img-fluid"></a></p>
</section>
<section id="d.-3-mismatches-1" class="level4" data-number="2.0.7.4">
<h4 data-number="2.0.7.4" class="anchored" data-anchor-id="d.-3-mismatches-1"><span class="header-section-number">2.0.7.4</span> D. 3 mismatches</h4>
<p><a href="figures/supp/upset_3.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="figures/supp/upset_3.svg" class="img-fluid"></a></p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"right","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>